<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ty.ibest.mapper.MerchantMapper">
	<resultMap id="BaseResult" type="com.ty.ibest.entity.Merchant">
		<id column="m_mid" property="merchantId"></id>

		<result column="m_name" property="name"></result>
		<result column="m_phone" property="phone"></result>
		<result column="m_province" property="province"></result>
		<result column="m_city" property="city"></result>
		<result column="m_region" property="region"></result>
		<result column="m_block" property="block"></result>
		<result column="m_wx_code" property="wxCode"></result>
		<result column="m_longitute" property="longitute"></result>
		<result column="m_latitude" property="latitude"></result>
		<result column="m_send_price" property="sendPrice"></result>
		<result column="m_open_time" property="openTime"></result>
		<result column="m_save_money" property="saveMoney"></result>
		<result column="m_profit" property="profit"></result>

	</resultMap>
	<select id="getMerchant" resultMap="BaseResult">
		SELECT *
		FROM
		m_merchant

	</select>
	<select id="searchByPhone" resultMap="BaseResult">
		SELECT *
		FROM
		m_merchant
		WHERE m_phone = #{phone}
	</select>
	<select id="isLogin" resultMap="BaseResult">
		SELECT *
		FROM
		m_merchant WHERE
		m_phone = #{phone} AND m_password = #{password}
	</select>
	<insert id="addMerchant" parameterType="Merchant"
		useGeneratedKeys="true" keyProperty="m_mid">
		INSERT INTO m_merchant(m_name,m_phone
		<!-- ,m_province,m_city, m_region,m_block,m_wx_code,m_longitute,m_latitude,m_send_price,m_open_time -->
		)
		VALUES(#{name
		},#{phone}

		<!-- ,#{province},#{city},#{region},#{block}, #{wxCode},#{longitute},#{latitude},#{sendPrice},#{openTime} -->
		)
	</insert>
	<insert id="registerMerchant" useGeneratedKeys="true">
		INSERT INTO m_merchant(m_phone, m_password)
		VALUES(#{phone},#{password})
		<selectKey resultType="int" order="AFTER" keyProperty="m_mid">
			SELECT LAST_INSERT_ID() AS m_mid
		</selectKey>
	</insert>

	<update id="updateMerchant" parameterType="Merchant">
		UPDATE m_merchant
		SET
		m_name =#{name},
		m_province = #{province},
		m_city = #{city},
		m_region =
		#{region},
		m_block = #{block},
		m_wx_code = #{wxCode},
		m_longitute =
		#{longitute},
		m_latitude = #{latitude},
		m_send_price = #{sendPrice},
		m_open_time = #{openTime}

		WHERE
		m_phone =
		#{phone}

	</update>

	<update id="payProfit">
		UPDATE m_merchant
		SET
		m_profit = 0


		WHERE
		m_mid =
		#{id}

	</update>

	<delete id="deleteMerchant" parameterType="int">
		DELETE FROM m_merchant
		WHERE m_mid = #{merchantId}
	</delete>
</mapper>