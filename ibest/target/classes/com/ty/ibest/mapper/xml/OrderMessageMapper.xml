<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ty.ibest.mapper.OrderMessageMapper">
	<resultMap id="BaseResult" type="com.ty.ibest.entity.OrderMessage">
		<id column="id" property="id"></id>
		<result column="m_mid" property="merchantId"></result>
		<result column="a_product_id" property="productId"></result>
		<result column="a_address_id" property="addressId"></result>
		<result column="a_user_id" property="userId"></result>
		<result column="a_buy_count" property="count"></result>
		<result column="a_status" property="status"></result>
		<association property="product"
			javaType="com.ty.ibest.entity.ProductAttribute">
			<id column="a_product_id" property="id"></id>
			<result column="p_name" property="name"></result>
			<result column="p_img_url" property="imgUrl"></result>
			<result column="p_origin_price" property="originPrice"></result>
			<result column="p_current_price" property="currentPrice"></result>
			<result column="p_sale" property="sale"></result>
			<result column="p_type" property="type"></result>
		</association>


	</resultMap>
	<select id="getOrder" resultMap="BaseResult">
		SELECT *
		FROM
		a_order,m_product
		WHERE a_order.a_product_id = m_product.id and a_order.m_mid =
		#{merchantId}
	</select>
	<!-- <select id="getOrder" resultMap="BaseResult"> SELECT o.id as id, o.merchantId 
		as m_mid, p.name as p_name FROM a_order o,m_product p WHERE o.a_product_id 
		= p.id and o.m_mid = #{merchantId} </select> -->
	<!-- <select id="getOrder" resultMap="BaseResult"> SELECT * FROM a_order 
		WHERE m_mid = #{merchantId} </select> -->
	<insert id="addOrder" parameterType="OrderMessage"
		useGeneratedKeys="true" keyProperty="id">
		INSERT INTO a_order(m_mid,
		a_product_id,a_address_id,a_user_id,a_buy_count,a_status)
		VALUES(#{merchantId},#{productId},#{addressId},#{userId},#{count},#{status})
	</insert>


</mapper>